package example

import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.types._

object HiveContextDemo {
  def main (args: Array[String]): Unit = {
    val spark: SparkSession = SparkSession
      .builder()
      .master("local[3]")
      .appName("AjaySingala")
      .getOrCreate()
    spark.sparkContext.setLogLevel("ERROR")
    val sc = spark.sparkContext

    println("Create SQLContext Object...")
    val sqlContext = new org.apache.spark.sql.hive.HiveContext(sc)

    println("Show customer details for amount higher than 29900...")
    val result = sqlContext.sql("SELECT customer_name, Customer_age, state, claim_category, amount FROM ins_wam WHERE amount>29900")

    println("Display the results...")
    result.printSchema()
    result.show()

  }
}